<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi Tool Hub - Fully Functional</title>
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Google Fonts: Poppins -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- LATEST TECH: CDN Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/qrcodejs@1.0.0/qrcode.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.1/dist/browser-image-compression.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@imgly/background-removal@1.4.0/dist/bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <script>
        // Set the worker source for PDF.js, required for it to work
        pdfjsLib.GlobalWorkerOptions.workerSrc = `https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.worker.min.js`;
    </script>

    <style>
        :root {
            --bg-color: #0F0F1B;
            --text-color: #E0E0E0;
            --text-muted: #A0A0B0;
            --accent-primary: #FACC15; /* Yellow */
            --accent-secondary: #FB923C; /* Orange */
            --accent-gradient: linear-gradient(45deg, var(--accent-primary), var(--accent-secondary));
            --glass-bg: rgba(28, 30, 51, 0.5);
            --border-color: rgba(255, 255, 255, 0.1);
            --shadow-color: rgba(0, 0, 0, 0.5);
            --shadow-glow: rgba(250, 204, 21, 0.15);
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            --border-radius: 16px;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
        body { background-color: var(--bg-color); color: var(--text-color); line-height: 1.7; min-height: 100vh; overflow-x: hidden; position: relative; }
        body::before, body::after { content: ''; position: fixed; z-index: -1; filter: blur(100px); -webkit-filter: blur(100px); }
        body::before { width: 400px; height: 400px; background: radial-gradient(circle, var(--accent-primary), transparent 60%); top: -10%; left: -10%; opacity: 0.3; animation: moveGlow1 25s infinite alternate; }
        body::after { width: 500px; height: 500px; background: radial-gradient(circle, var(--accent-secondary), transparent 60%); bottom: -15%; right: -15%; opacity: 0.2; animation: moveGlow2 30s infinite alternate; }
        @keyframes moveGlow1 { from { transform: translate(-10%, -10%) rotate(0deg); } to { transform: translate(20%, 30%) rotate(180deg); } }
        @keyframes moveGlow2 { from { transform: translate(15%, 15%) rotate(0deg); } to { transform: translate(-25%, -20%) rotate(-180deg); } }
        header { background: var(--glass-bg); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); padding: 1.5rem; text-align: center; box-shadow: 0 4px 30px var(--shadow-color); position: fixed; top: 0; left: 0; right: 0; z-index: 100; border-bottom: 1px solid var(--border-color); }
        body { padding-top: 180px; }
        .header-content { max-width: 1200px; margin: 0 auto; }
        header h1 { font-size: 2.8rem; font-weight: 700; background: var(--accent-gradient); -webkit-background-clip: text; background-clip: text; color: transparent; margin-bottom: 0.5rem; }
        .tagline { font-size: 1.1rem; color: var(--text-muted); max-width: 600px; margin: 0 auto 1.2rem; }
        .stats { display: flex; gap: 15px; flex-wrap: wrap; justify-content: center; }
        .stat-item { display: flex; align-items: center; gap: 8px; background: rgba(255, 255, 255, 0.05); padding: 8px 18px; border-radius: 50px; font-size: 0.9rem; border: 1px solid var(--border-color); transition: var(--transition); }
        .stat-item:hover { transform: translateY(-3px); background: rgba(255, 255, 255, 0.1); }
        .stat-item i { color: var(--accent-primary); }
        .container { max-width: 1400px; margin: 3rem auto; padding: 0 1.5rem; }
        .section-title { text-align: center; margin-bottom: 3.5rem; font-size: 2.5rem; font-weight: 600; }
        .tools-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 30px; }
        .tool-card { background: var(--glass-bg); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border-radius: var(--border-radius); padding: 2rem; text-align: left; transition: var(--transition); box-shadow: 0 8px 32px var(--shadow-color); border: 1px solid var(--border-color); cursor: pointer; position: relative; overflow: hidden; }
        .tool-card::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: radial-gradient(circle at var(--mouse-x) var(--mouse-y), rgba(255, 255, 255, 0.1), transparent 40%); opacity: 0; transition: opacity 0.4s; }
        .tool-card:hover::before { opacity: 1; }
        .tool-card:hover { transform: translateY(-8px); box-shadow: 0 12px 40px var(--shadow-color), 0 0 20px var(--shadow-glow); border-color: rgba(250, 204, 21, 0.5); }
        .tool-icon-wrapper { background: rgba(255, 255, 255, 0.05); width: 70px; height: 70px; border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-bottom: 1.5rem; transition: var(--transition); }
        .tool-card:hover .tool-icon-wrapper { background: var(--accent-gradient); }
        .tool-icon { font-size: 2.5rem; color: var(--accent-primary); transition: var(--transition); }
        .tool-card:hover .tool-icon { color: var(--bg-color); transform: scale(1.1) rotate(-5deg); }
        .tool-title { font-size: 1.5rem; font-weight: 600; margin-bottom: 0.8rem; }
        .tool-desc { color: var(--text-muted); font-size: 1rem; }
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.6); z-index: 1000; align-items: center; justify-content: center; padding: 1rem; opacity: 0; transition: opacity 0.4s ease; }
        .modal.active { display: flex; opacity: 1; }
        .modal-content { background: var(--glass-bg); backdrop-filter: blur(15px); -webkit-backdrop-filter: blur(15px); border-radius: var(--border-radius); max-width: 900px; width: 100%; max-height: 90vh; overflow-y: auto; box-shadow: 0 20px 50px var(--shadow-color); position: relative; padding: 2.5rem; transform: scale(0.95); transition: transform 0.4s ease; border: 1px solid var(--border-color); }
        .modal.active .modal-content { transform: scale(1); }
        .close-btn { position: absolute; top: 15px; right: 20px; font-size: 2rem; color: var(--text-muted); cursor: pointer; transition: var(--transition); background: none; border: none; width: 45px; height: 45px; display: flex; align-items: center; justify-content: center; border-radius: 50%; }
        .close-btn:hover { color: var(--accent-primary); background: rgba(255, 255, 255, 0.1); transform: rotate(90deg); }
        .modal-header { margin-bottom: 2rem; text-align: center; }
        .modal-header h2 { font-size: 2.2rem; font-weight: 600; background: var(--accent-gradient); -webkit-background-clip: text; background-clip: text; color: transparent; margin-bottom: 0.5rem; }
        .modal-subtitle { color: var(--text-muted); font-size: 1.1rem; }
        .tool-container { padding: 1rem 0; }
        .tool-layout { display: grid; grid-template-columns: 1fr; gap: 2rem; }
        .tool-layout.two-column { grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); }
        .input-group { margin-bottom: 1.5rem; position: relative; }
        .input-group label { display: block; margin-bottom: 0.8rem; font-weight: 500; font-size: 1.1rem; }
        input, select, textarea, button { width: 100%; padding: 1rem 1.2rem; border-radius: 12px; border: 1px solid var(--border-color); background: rgba(0, 0, 0, 0.2); color: var(--text-color); font-size: 1rem; transition: var(--transition); }
        input:focus, select:focus, textarea:focus { outline: none; border-color: var(--accent-primary); box-shadow: 0 0 0 4px var(--shadow-glow); }
        textarea { resize: vertical; min-height: 120px; }
        button { background: var(--accent-gradient); color: var(--bg-color); border: none; font-weight: 600; cursor: pointer; margin-top: 1rem; font-size: 1.1rem; letter-spacing: 0.5px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2); }
        button:hover { transform: translateY(-3px); box-shadow: 0 8px 25px var(--shadow-color); }
        button:disabled { background: var(--text-muted); cursor: not-allowed; }
        .result-container { background: rgba(0, 0, 0, 0.2); border-radius: var(--border-radius); padding: 1.5rem; margin-top: 1.5rem; border: 1px solid var(--border-color); }
        .result-title { font-size: 1.3rem; margin-bottom: 1rem; color: var(--text-color); font-weight: 500; display: flex; align-items: center; gap: 10px; }
        .result-title i { color: var(--accent-primary); font-size: 1.2rem; }
        .file-drop-area { border: 2px dashed var(--border-color); border-radius: var(--border-radius); padding: 2.5rem; text-align: center; cursor: pointer; transition: var(--transition); background: rgba(0,0,0,0.1); }
        .file-drop-area.dragover { border-color: var(--accent-primary); background: rgba(250, 204, 21, 0.1); }
        .file-drop-area i { font-size: 3rem; color: var(--accent-primary); margin-bottom: 1rem; }
        .notification { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(150%); padding: 1rem 1.5rem; border-radius: 12px; background: var(--glass-bg); backdrop-filter: blur(10px); border: 1px solid var(--border-color); color: var(--text-color); font-weight: 500; box-shadow: 0 8px 25px var(--shadow-color); transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 2000; display: flex; align-items: center; gap: 12px; }
        .notification.show { transform: translateX(-50%) translateY(0); }
        .notification i { color: var(--accent-primary); }
        .copy-btn { position: absolute; top: 50%; right: 10px; transform: translateY(-50%); background: none; border: none; color: var(--text-muted); cursor: pointer; font-size: 1.2rem; padding: 5px; margin: 0;}
        .input-group .copy-btn { top: auto; bottom: 12px; right: 12px; transform: none; }
        #fileList { list-style: none; margin-top: 1rem; max-height: 150px; overflow-y: auto; background: rgba(0,0,0,0.1); padding: 1rem; border-radius: 8px;}
        #fileList li { padding: 0.5rem; border-bottom: 1px solid var(--border-color); font-size: 0.9rem; }
        .progress-bar { width: 100%; background: rgba(0,0,0,0.3); border-radius: 8px; padding: 3px; margin-top: 1rem; display: none; }
        .progress-bar-inner { width: 0%; height: 10px; background: var(--accent-gradient); border-radius: 5px; transition: width 0.3s ease; }
        #progressText { text-align: center; font-size: 0.9rem; margin-top: 0.5rem; color: var(--text-muted); }
        /* ... (other styles like footer, ads, etc. are unchanged) ... */
    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <h1>Multi Tool Hub</h1>
            <p class="tagline">Your all-in-one solution for everyday digital tasks. Fast, secure, and beautiful.</p>
            <div class="stats">
                <div class="stat-item"><i class="fas fa-tools"></i><span>16 Tools</span></div>
                <div class="stat-item"><i class="fas fa-shield-halved"></i><span>100% Client-Side</span></div>
                <div class="stat-item"><i class="fas fa-bolt"></i><span>Blazing Fast</span></div>
            </div>
        </div>
    </header>

    <div class="container">
        <h2 class="section-title">Explore Our Tools</h2>
        <div class="tools-grid"></div>
    </div>

    <div class="modal" id="toolModal">
        <div class="modal-content">
            <button class="close-btn">×</button>
            <div class="modal-header">
                <h2 id="modalTitle">Tool Name</h2>
                <p class="modal-subtitle" id="modalSubtitle">Tool description appears here</p>
            </div>
            <div class="tool-container" id="toolContainer"></div>
        </div>
    </div>

    <div class="notification" id="notification">
        <i class="fas fa-info-circle"></i>
        <span>Processing...</span>
    </div>
    
    <footer class="footer">
        <!-- Footer content can be added here if needed -->
    </footer>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const tools = [
            { id: 'imageConverter', icon: 'fas fa-exchange-alt', name: 'Image Format Converter', desc: 'Convert between JPG, PNG, and WEBP formats.' },
            { id: 'imageCompressor', icon: 'fas fa-compress-alt', name: 'Image Compressor', desc: 'Reduce file size with minimal quality loss.' },
            { id: 'backgroundRemover', icon: 'fas fa-wand-magic-sparkles', name: 'AI Background Remover', desc: 'Automatically remove the background from any image.' },
            { id: 'pdfConverter', icon: 'fas fa-file-pdf', name: 'Image to PDF Converter', desc: 'Combine multiple images into a single PDF file.' },
            { id: 'pdfTextExtractor', icon: 'fas fa-file-alt', name: 'PDF Text Extractor', desc: 'Extract all text content from a PDF file.' },
            { id: 'qrGenerator', icon: 'fas fa-qrcode', name: 'QR Code Generator', desc: 'Create QR codes for URLs and text.' },
            { id: 'passwordGenerator', icon: 'fas fa-key', name: 'Password Generator', desc: 'Create secure, random passwords instantly.' },
            { id: 'ageCalculator', icon: 'fas fa-birthday-cake', name: 'Age Calculator', desc: 'Find your exact age in years, months, and days.' },
            { id: 'emiCalculator', icon: 'fas fa-calculator', name: 'EMI Calculator', desc: 'Calculate your Equated Monthly Installments.' },
            { id: 'wordCounter', icon: 'fas fa-font', name: 'Word & Character Counter', desc: 'Analyze text for counts and reading time.' },
            { id: 'colorPicker', icon: 'fas fa-palette', name: 'Color Picker', desc: 'Pick colors and get HEX, RGB, HSL values.' },
            { id: 'base64Converter', icon: 'fas fa-code', name: 'Base64 Converter', desc: 'Encode and decode strings to/from Base64.' },
            { id: 'bmiCalculator', icon: 'fas fa-weight', name: 'BMI Calculator', desc: 'Calculate your Body Mass Index quickly.' },
            { id: 'timerStopwatch', icon: 'fas fa-stopwatch', name: 'Timer & Stopwatch', desc: 'Track time with precision and ease.' },
            { id: 'jsonFormatter', icon: 'fas fa-brackets-curly', name: 'JSON Formatter', desc: 'Format, validate, and beautify JSON data.' },
            { id: 'textToSpeech', icon: 'fas fa-volume-up', name: 'Text to Speech', desc: 'Convert text into natural-sounding audio.' },
        ];
        
        const modalAdTemplate = `<div class="ad-container" style="margin-top:2rem;"><span class="ad-label">Advertisement</span><div class="ad-placeholder-content" style="min-height:60px;"><p>Your Ad Here</p></div></div>`;
        const toolTemplates = {
            imageConverter: `<div class="tool-layout two-column"><div><div class="file-drop-area" id="fileDropArea"><i class="fas fa-upload"></i><p>Drop image here or click to select</p></div><input type="file" id="fileInput" accept="image/*" hidden><div class="input-group"><label for="imageFormat">Convert To:</label><select id="imageFormat"><option value="jpeg">JPG</option><option value="png">PNG</option><option value="webp">WEBP</option></select></div><button id="convertBtn" disabled>Convert Image</button></div><div class="result-container" id="resultContainer" style="display:none;"><div class="result-title"><i class="fas fa-check-circle"></i>Conversion Complete</div><img id="imagePreview" style="max-width:100%; border-radius:8px; margin-bottom:1rem;"><a id="downloadLink" download="converted-image"><button style="width:100%">Download Image</button></a></div></div>`,
            imageCompressor: `<div class="tool-layout two-column"><div><div class="file-drop-area" id="fileDropArea"><i class="fas fa-upload"></i><p>Drop image here or click to select</p></div><input type="file" id="fileInput" accept="image/*" hidden><div class="input-group"><label for="maxSizeMB">Max Size (MB):</label><input type="number" id="maxSizeMB" value="1" step="0.1"></div><button id="compressBtn" disabled>Compress Image</button></div><div class="result-container" id="resultContainer" style="display:none;"><div class="result-title"><i class="fas fa-check-circle"></i>Compression Complete</div><div id="compressionInfo" class="result-content" style="margin-bottom:1rem;"></div><a id="downloadLink" download="compressed-image"><button style="width:100%">Download Compressed Image</button></a></div></div>`,
            backgroundRemover: `<div class="tool-layout two-column"><div><div class="file-drop-area" id="fileDropArea"><i class="fas fa-upload"></i><p>Drop an image here or click to select</p></div><input type="file" id="fileInput" accept="image/*" hidden><img id="originalImagePreview" style="display:none;max-width:100%; border-radius:8px; margin-top:1rem;"><div class="progress-bar" id="progressBar"><div class="progress-bar-inner"></div></div><div id="progressText"></div><button id="removeBgBtn" disabled>Remove Background</button></div><div class="result-container" id="resultContainer" style="display:none;"><div class="result-title"><i class="fas fa-check-circle"></i>Result</div><img id="resultImagePreview" style="max-width:100%; border-radius:8px; margin-top:1rem;"><a id="downloadLink" download="background-removed.png"><button style="width:100%">Download PNG</button></a></div></div>`,
            pdfConverter: `<div class="tool-layout two-column"><div><div class="file-drop-area" id="fileDropArea"><i class="fas fa-file-image"></i><p>Drop images here or click to select</p></div><input type="file" id="fileInput" accept="image/*" multiple hidden><div id="fileListContainer" style="display:none;"><label>Selected Files:</label><ul id="fileList"></ul></div><button id="convertBtn" disabled>Convert to PDF</button></div><div class="result-container"><div class="result-title"><i class="fas fa-info-circle"></i>Instructions</div><div class="result-content" style="font-size: 0.95rem;"><ol><li>Select one or more images (JPG, PNG, WEBP).</li><li>Images will be added to the PDF in the order selected.</li><li>Click "Convert to PDF" to generate and download.</li></ol></div></div></div>`,
            pdfTextExtractor: `<div class="tool-layout two-column"><div><div class="file-drop-area" id="fileDropArea"><i class="fas fa-file-pdf"></i><p>Drop a PDF here or click to select</p></div><input type="file" id="fileInput" accept="application/pdf" hidden><button id="extractBtn" disabled>Extract Text</button></div><div class="result-container" id="resultContainer" style="display:none;"><div class="result-title"><i class="fas fa-file-alt"></i>Extracted Text</div><textarea id="extractedText" readonly style="min-height: 250px;"></textarea><button id="copyBtn" style="width: 100%;">Copy Text</button></div></div>`,
            qrGenerator: `<div class="tool-layout two-column"><div><div class="input-group"><label for="qrText">Text or URL:</label><textarea id="qrText" placeholder="https://example.com"></textarea></div><button id="generateBtn">Generate QR Code</button></div><div class="result-container" id="resultContainer" style="display:none; align-items:center; justify-content:center; flex-direction:column;"><div id="qrcode" style="padding:10px; background:white; border-radius:8px;"></div><a id="downloadLink" download="qrcode.png"><button style="width:100%">Download PNG</button></a></div></div>`,
            passwordGenerator: `<div class="tool-layout two-column"><div><div class="input-group"><label>Generated Password</label><input type="text" id="passwordOutput" placeholder="Click 'Generate'..." readonly><button class="copy-btn" id="copyPasswordBtn" title="Copy"><i class="far fa-copy"></i></button></div><div class="input-group"><label for="passwordLength">Length: <span id="passwordLengthValue" style="color:var(--accent-primary); font-weight:bold;">16</span></label><input type="range" id="passwordLength" min="8" max="64" value="16"></div><div style="display:grid;grid-template-columns:1fr 1fr;gap:1rem;"><div style="display:flex;align-items:center;gap:10px;"><input type="checkbox" id="includeUppercase" checked style="width:auto;"><label for="includeUppercase">A-Z</label></div><div style="display:flex;align-items:center;gap:10px;"><input type="checkbox" id="includeLowercase" checked style="width:auto;"><label for="includeLowercase">a-z</label></div><div style="display:flex;align-items:center;gap:10px;"><input type="checkbox" id="includeNumbers" checked style="width:auto;"><label for="includeNumbers">0-9</label></div><div style="display:flex;align-items:center;gap:10px;"><input type="checkbox" id="includeSymbols" style="width:auto;"><label for="includeSymbols">!@#</label></div></div><button id="generatePasswordBtn">Generate Password</button></div><div class="result-container"><div class="result-title"><i class="fas fa-shield-alt"></i>Security Tips</div><ul style="padding-left:1.5rem;font-size:0.95rem;"><li>Use longer passwords for better security.</li><li>Never reuse passwords across different sites.</li><li>Use a password manager to store passwords securely.</li></ul></div></div>`,
            ageCalculator: `<div class="input-group"><label for="birthDate">Enter Your Date of Birth</label><input type="date" id="birthDate"></div><button id="calculateAgeBtn">Calculate Age</button><div class="result-container" id="ageResultContainer" style="display:none;"><div class="result-title"><i class="fas fa-gift"></i>Your Age</div><div id="ageResult" style="text-align:center; font-size: 1.8rem; margin-bottom: 2rem;"></div><div class="result-title"><i class="fas fa-calendar-alt"></i>In Other Units</div><div id="ageUnitsResult" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:1rem;"></div></div>`,
            emiCalculator: `<div class="tool-layout two-column"><div><div class="input-group"><label for="loanAmount">Loan Amount ($)</label><input type="number" id="loanAmount" placeholder="e.g., 100000"></div><div class="input-group"><label for="interestRate">Annual Interest Rate (%)</label><input type="number" id="interestRate" placeholder="e.g., 5.5"></div><div class="input-group"><label for="loanTenure">Loan Tenure (Years)</label><input type="number" id="loanTenure" placeholder="e.g., 20"></div><button id="calculateEmiBtn">Calculate EMI</button></div><div class="result-container" id="emiResultContainer" style="display:none;"><div class="result-title"><i class="fas fa-chart-pie"></i>Loan Summary</div><div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:1rem;"><div class="result-item" style="background:rgba(0,0,0,0.2);padding:1rem;border-radius:8px;"><span>Monthly EMI</span><strong id="monthlyEmiResult" style="font-size:1.4rem;display:block;"></strong></div><div class="result-item" style="background:rgba(0,0,0,0.2);padding:1rem;border-radius:8px;"><span>Total Interest</span><strong id="totalInterestResult" style="font-size:1.4rem;display:block;"></strong></div><div class="result-item" style="background:rgba(0,0,0,0.2);padding:1rem;border-radius:8px;"><span>Total Payment</span><strong id="totalPaymentResult" style="font-size:1.4rem;display:block;"></strong></div></div></div></div>`,
            wordCounter: `<div class="tool-layout two-column"><div class="input-group"><label for="textInput">Your Text</label><textarea id="textInput" placeholder="Paste your text here..." style="min-height: 300px;"></textarea></div><div class="result-container"><div class="result-title"><i class="fas fa-chart-bar"></i>Text Analysis</div><div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:1rem;"><div class="result-item" style="background:rgba(0,0,0,0.2);padding:1rem;border-radius:8px;"><span>Words</span><strong id="wordCount">0</strong></div><div class="result-item" style="background:rgba(0,0,0,0.2);padding:1rem;border-radius:8px;"><span>Characters</span><strong id="charCount">0</strong></div><div class="result-item" style="background:rgba(0,0,0,0.2);padding:1rem;border-radius:8px;"><span>Sentences</span><strong id="sentenceCount">0</strong></div><div class="result-item" style="background:rgba(0,0,0,0.2);padding:1rem;border-radius:8px;"><span>Paragraphs</span><strong id="paragraphCount">0</strong></div></div><div class="result-title" style="margin-top:2rem;"><i class="far fa-clock"></i>Reading Time</div><strong id="readingTime">0 min</strong></div></div>`,
            colorPicker: `<div class="tool-layout two-column"><div><div class="input-group"><label>Pick a Color</label><input type="color" id="colorPickerInput" value="#FACC15" style="padding:0.5rem;height:60px;cursor:pointer;"></div><div id="colorPreview" style="width:100%;height:150px;border-radius:12px;transition:background-color 0.3s;"></div></div><div><div class="input-group"><label>HEX</label><input type="text" id="hexValue" readonly><button class="copy-btn" data-copy="hexValue"><i class="far fa-copy"></i></button></div><div class="input-group"><label>RGB</label><input type="text" id="rgbValue" readonly><button class="copy-btn" data-copy="rgbValue"><i class="far fa-copy"></i></button></div><div class="input-group"><label>HSL</label><input type="text" id="hslValue" readonly><button class="copy-btn" data-copy="hslValue"><i class="far fa-copy"></i></button></div></div></div>`,
            base64Converter: `<div class="tool-layout two-column"><div><div class="input-group"><label for="base64TextInput">Text</label><textarea id="base64TextInput" placeholder="Type or paste text..."></textarea></div><button id="encodeBtn"><i class="fas fa-arrow-down"></i> Encode to Base64</button></div><div><div class="input-group"><label for="base64Output">Base64</label><textarea id="base64Output" placeholder="Base64 output..."></textarea></div><button id="decodeBtn"><i class="fas fa-arrow-up"></i> Decode from Base64</button></div></div>`,
            bmiCalculator: `<div class="unit-switcher" style="display:flex;background:rgba(0,0,0,0.2);border-radius:10px;padding:5px;margin-bottom:1.5rem;"><button id="metricBtn" class="active" style="flex:1;padding:0.6rem;border:none;background:transparent;color:var(--text-muted);font-weight:500;cursor:pointer;transition:var(--transition);border-radius:8px;margin:0;">Metric (kg, cm)</button><button id="imperialBtn" style="flex:1;padding:0.6rem;border:none;background:transparent;color:var(--text-muted);font-weight:500;cursor:pointer;transition:var(--transition);border-radius:8px;margin:0;">Imperial (lbs, ft, in)</button></div><div id="metricInputs"><div class="tool-layout two-column"><div class="input-group"><label for="metricWeight">Weight (kg)</label><input type="number" id="metricWeight" placeholder="e.g., 70"></div><div class="input-group"><label for="metricHeight">Height (cm)</label><input type="number" id="metricHeight" placeholder="e.g., 175"></div></div></div><div id="imperialInputs" style="display:none;"><div class="tool-layout" style="grid-template-columns:repeat(auto-fit,minmax(150px,1fr));"><div class="input-group"><label for="imperialWeight">Weight (lbs)</label><input type="number" id="imperialWeight" placeholder="e.g., 154"></div><div class="input-group"><label for="imperialHeightFt">Height (ft)</label><input type="number" id="imperialHeightFt" placeholder="e.g., 5"></div><div class="input-group"><label for="imperialHeightIn">Height (in)</label><input type="number" id="imperialHeightIn" placeholder="e.g., 9"></div></div></div><button id="calculateBmiBtn">Calculate BMI</button><div class="result-container" id="bmiResultContainer" style="display:none;"><div class="result-title"><i class="fas fa-heartbeat"></i>Your BMI Result</div><div style="text-align:center;"><span style="font-size:1.2rem;">Your BMI is</span><br><strong id="bmiValue" style="font-size:3rem;color:var(--accent-primary);">0.0</strong><br><span id="bmiCategory" style="font-size:1.5rem;font-weight:500;"></span></div><div id="bmiResultGauge" style="width:100%;height:20px;background:rgba(0,0,0,0.3);border-radius:10px;overflow:hidden;margin:1rem 0;"><div id="bmiResultGaugeIndicator" style="height:100%;width:0%;transition:width 0.5s ease, background-color 0.5s ease;border-radius:10px;"></div></div></div>`,
            timerStopwatch: `<div class="tool-layout two-column"><div><div class="result-title"><i class="fas fa-hourglass-half"></i>Timer</div><div style="font-size:3rem;text-align:center;margin:1rem 0;font-family:monospace;" id="timerDisplay">00:00</div><div class="input-group"><label>Minutes: <input type="number" id="timerMinutes" value="5" min="0"></label></div><div style="display:flex;gap:1rem;justify-content:center;"><button id="startTimerBtn">Start</button><button id="resetTimerBtn">Reset</button></div></div><div><div class="result-title"><i class="fas fa-stopwatch"></i>Stopwatch</div><div style="font-size:3rem;text-align:center;margin:1rem 0;font-family:monospace;" id="stopwatchDisplay">00:00.00</div><div style="display:flex;gap:1rem;justify-content:center;"><button id="startStopwatchBtn">Start</button><button id="resetStopwatchBtn">Reset</button></div></div></div>`,
            jsonFormatter: `<div class="tool-layout two-column"><div><div class="input-group"><label for="jsonInput">Paste your JSON here:</label><textarea id="jsonInput" placeholder='{ "key": "value" }'></textarea></div><button id="formatBtn">Format / Validate</button></div><div class="result-container"><div class="result-title" id="jsonResultTitle"><i class="fas fa-code"></i>Formatted JSON</div><pre><code id="jsonOutput" style="white-space:pre-wrap;word-wrap:break-word;"></code></pre><button id="copyBtn" style="display:none;">Copy Formatted JSON</button></div></div>`,
            textToSpeech: `<div class="input-group"><label for="ttsText">Text to Speak:</label><textarea id="ttsText" placeholder="Hello world! Welcome to Multi Tool Hub."></textarea></div><div class="input-group"><label for="voiceSelect">Select Voice:</label><select id="voiceSelect"></select></div><button id="speakBtn">Speak</button>`,
        };
        
        const toolsGrid = document.querySelector('.tools-grid');
        const modal = document.getElementById('toolModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalSubtitle = document.getElementById('modalSubtitle');
        const toolContainer = document.getElementById('toolContainer');
        const closeBtn = document.querySelector('.close-btn');
        const notification = document.getElementById('notification');
        let activeToolIntervals = [];

        function init() {
            populateTools();
            addEventListeners();
        }

        function populateTools() {
            document.querySelector('.stat-item span').textContent = `${tools.length} Tools`;
            toolsGrid.innerHTML = tools.map(tool => `<div class="tool-card" data-tool="${tool.id}"><div class="tool-icon-wrapper"><i class="tool-icon ${tool.icon}"></i></div><div><h3 class="tool-title">${tool.name}</h3><p class="tool-desc">${tool.desc}</p></div></div>`).join('');
        }
        
        function addEventListeners() {
            document.body.addEventListener('click', e => {
                const card = e.target.closest('.tool-card');
                if (card) openTool(card.dataset.tool);
            });
            closeBtn.addEventListener('click', closeModal);
            modal.addEventListener('click', e => { if (e.target === modal) closeModal(); });
            document.querySelectorAll('.tool-card').forEach(card => {
                card.addEventListener('mousemove', e => {
                    const rect = card.getBoundingClientRect();
                    card.style.setProperty('--mouse-x', `${e.clientX - rect.left}px`);
                    card.style.setProperty('--mouse-y', `${e.clientY - rect.top}px`);
                });
            });
        }
        
        function openTool(toolId) {
            const toolData = tools.find(t => t.id === toolId);
            if (!toolData) return;
            modalTitle.textContent = toolData.name;
            modalSubtitle.textContent = toolData.desc;
            toolContainer.innerHTML = (toolTemplates[toolId] || `<p>Tool not found.</p>`) + modalAdTemplate;
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
            initToolScript(toolId);
        }

        function closeModal() {
            modal.classList.remove('active');
            document.body.style.overflow = 'auto';
            activeToolIntervals.forEach(clearInterval);
            activeToolIntervals = [];
            if (speechSynthesis.speaking) speechSynthesis.cancel();
        }

        function showNotification(message, isSuccess = true) {
            notification.querySelector('span').textContent = message;
            notification.querySelector('i').className = isSuccess ? 'fas fa-check-circle' : 'fas fa-exclamation-circle';
            notification.classList.add('show');
            setTimeout(() => notification.classList.remove('show'), 3000);
        }
        
        function setButtonLoading(button, isLoading, originalText = 'Process') {
            if (isLoading) {
                button.disabled = true;
                button.innerHTML = `<i class="fas fa-spinner fa-spin"></i> Processing...`;
            } else {
                button.disabled = false;
                button.innerHTML = originalText;
            }
        }
        
        function copyToClipboard(text, successMessage) {
            navigator.clipboard.writeText(text).then(() => showNotification(successMessage || 'Copied!'));
        }

        function handleFileDrop(area, input, onFile, isMultiple = false) {
            area.addEventListener('click', () => input.click());
            area.addEventListener('dragover', e => { e.preventDefault(); area.classList.add('dragover'); });
            area.addEventListener('dragleave', () => area.classList.remove('dragover'));
            area.addEventListener('drop', e => {
                e.preventDefault();
                area.classList.remove('dragover');
                if (e.dataTransfer.files.length) {
                    isMultiple ? onFile(e.dataTransfer.files) : onFile(e.dataTransfer.files[0]);
                }
            });
            input.addEventListener('change', e => {
                if (e.target.files.length) {
                    isMultiple ? onFile(e.target.files) : onFile(e.target.files[0]);
                }
            });
        }
        
        function initToolScript(toolId){
            switch(toolId) {
                case 'imageConverter': initImageConverter(); break;
                case 'imageCompressor': initImageCompressor(); break;
                case 'backgroundRemover': initBackgroundRemover(); break;
                case 'pdfConverter': initPdfConverter(); break;
                case 'pdfTextExtractor': initPdfTextExtractor(); break;
                case 'qrGenerator': initQrGenerator(); break;
                case 'passwordGenerator': initPasswordGenerator(); break;
                case 'ageCalculator': initAgeCalculator(); break;
                case 'emiCalculator': initEmiCalculator(); break;
                case 'wordCounter': initWordCounter(); break;
                case 'colorPicker': initColorPicker(); break;
                case 'base64Converter': initBase64Converter(); break;
                case 'bmiCalculator': initBmiCalculator(); break;
                case 'timerStopwatch': initTimerStopwatch(); break;
                case 'jsonFormatter': initJsonFormatter(); break;
                case 'textToSpeech': initTextToSpeech(); break;
            }
        }
        
        function initImageConverter() {
            const fileDropArea = document.getElementById('fileDropArea');
            const fileInput = document.getElementById('fileInput');
            const convertBtn = document.getElementById('convertBtn');
            const resultContainer = document.getElementById('resultContainer');
            const imagePreview = document.getElementById('imagePreview');
            const downloadLink = document.getElementById('downloadLink');
            let originalFile = null;
            handleFileDrop(fileDropArea, fileInput, file => {
                if (!file.type.startsWith('image/')) { showNotification('Please select an image file.', false); return; }
                originalFile = file;
                convertBtn.disabled = false;
                fileDropArea.querySelector('p').textContent = file.name;
            });
            convertBtn.addEventListener('click', () => {
                if (!originalFile) return;
                const format = document.getElementById('imageFormat').value;
                setButtonLoading(convertBtn, true, 'Convert Image');
                const reader = new FileReader();
                reader.onload = e => {
                    const img = new Image();
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        canvas.width = img.width; canvas.height = img.height;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0);
                        canvas.toBlob(blob => {
                            const url = URL.createObjectURL(blob);
                            downloadLink.href = url;
                            downloadLink.download = `${originalFile.name.split('.')[0]}.${format === 'jpeg' ? 'jpg' : format}`;
                            imagePreview.src = url;
                            resultContainer.style.display = 'block';
                            setButtonLoading(convertBtn, false, 'Convert Image');
                            showNotification('Conversion successful!');
                        }, `image/${format}`, 0.95);
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(originalFile);
            });
        }
        
        async function initImageCompressor() {
            const fileDropArea = document.getElementById('fileDropArea');
            const fileInput = document.getElementById('fileInput');
            const compressBtn = document.getElementById('compressBtn');
            const resultContainer = document.getElementById('resultContainer');
            const compressionInfo = document.getElementById('compressionInfo');
            const downloadLink = document.getElementById('downloadLink');
            let originalFile = null;
            handleFileDrop(fileDropArea, fileInput, file => {
                if (!file.type.startsWith('image/')) { showNotification('Please select an image file.', false); return; }
                originalFile = file;
                compressBtn.disabled = false;
                fileDropArea.querySelector('p').textContent = file.name;
            });
            compressBtn.addEventListener('click', async () => {
                if (!originalFile) return;
                setButtonLoading(compressBtn, true, 'Compress Image');
                const options = { maxSizeMB: parseFloat(document.getElementById('maxSizeMB').value) || 1, maxWidthOrHeight: 1920, useWebWorker: true };
                try {
                    const compressedFile = await imageCompression(originalFile, options);
                    const originalSize = (originalFile.size / 1024 / 1024).toFixed(2);
                    const compressedSize = (compressedFile.size / 1024 / 1024).toFixed(2);
                    const reduction = (((originalFile.size - compressedFile.size) / originalFile.size) * 100).toFixed(1);
                    compressionInfo.innerHTML = `Original Size: <strong>${originalSize} MB</strong><br>Compressed Size: <strong>${compressedSize} MB</strong><br>Reduction: <strong>${reduction}%</strong>`;
                    downloadLink.href = URL.createObjectURL(compressedFile);
                    downloadLink.download = `compressed-${originalFile.name}`;
                    resultContainer.style.display = 'block';
                    showNotification('Compression successful!');
                } catch (error) {
                    showNotification('Compression failed.', false);
                } finally {
                    setButtonLoading(compressBtn, false, 'Compress Image');
                }
            });
        }
        
        async function initBackgroundRemover() {
            const fileDropArea = document.getElementById('fileDropArea');
            const fileInput = document.getElementById('fileInput');
            const removeBgBtn = document.getElementById('removeBgBtn');
            const originalPreview = document.getElementById('originalImagePreview');
            const resultContainer = document.getElementById('resultContainer');
            const resultPreview = document.getElementById('resultImagePreview');
            const downloadLink = document.getElementById('downloadLink');
            const progressBar = document.getElementById('progressBar');
            const progressBarInner = progressBar.querySelector('.progress-bar-inner');
            const progressText = document.getElementById('progressText');
            let imageFile = null;
            handleFileDrop(fileDropArea, fileInput, file => {
                if (!file.type.startsWith('image/')) { showNotification('Please select an image file.', false); return; }
                imageFile = file;
                originalPreview.src = URL.createObjectURL(file);
                originalPreview.style.display = 'block';
                removeBgBtn.disabled = false;
                resultContainer.style.display = 'none';
            });
            removeBgBtn.addEventListener('click', async () => {
                if (!imageFile) return;
                setButtonLoading(removeBgBtn, true, 'Remove Background');
                progressBar.style.display = 'block';
                progressText.textContent = 'Initializing...';
                try {
                    const blob = await removeBackground(imageFile, {
                        progress: (key, current, total) => {
                            const percent = (current / total) * 100;
                            progressBarInner.style.width = `${percent}%`;
                            progressText.textContent = `Processing: ${key.replace(/-/g, ' ')}...`;
                        }
                    });
                    const url = URL.createObjectURL(blob);
                    resultPreview.src = url;
                    downloadLink.href = url;
                    resultContainer.style.display = 'block';
                    showNotification('Background removed!');
                } catch(error) {
                    showNotification('Could not process image.', false);
                } finally {
                    setButtonLoading(removeBgBtn, false, 'Remove Background');
                    progressBar.style.display = 'none';
                    progressText.textContent = '';
                }
            });
        }
        
        async function initPdfConverter() {
            const fileDropArea = document.getElementById('fileDropArea');
            const fileInput = document.getElementById('fileInput');
            const convertBtn = document.getElementById('convertBtn');
            const fileListContainer = document.getElementById('fileListContainer');
            const fileList = document.getElementById('fileList');
            let selectedFiles = [];
            const updateUI = () => {
                fileList.innerHTML = '';
                if (selectedFiles.length > 0) {
                    selectedFiles.forEach(file => { fileList.appendChild(document.createElement('li')).textContent = file.name; });
                    fileListContainer.style.display = 'block';
                    convertBtn.disabled = false;
                } else {
                    fileListContainer.style.display = 'none';
                    convertBtn.disabled = true;
                }
            };
            handleFileDrop(fileDropArea, fileInput, (files) => {
                selectedFiles.push(...Array.from(files).filter(file => file.type.startsWith('image/')));
                updateUI();
            }, true);
            convertBtn.addEventListener('click', async () => {
                if (selectedFiles.length === 0) { showNotification('Please select images.', false); return; }
                setButtonLoading(convertBtn, true, 'Convert to PDF');
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                const pageW = pdf.internal.pageSize.getWidth();
                const pageH = pdf.internal.pageSize.getHeight();
                for (let i = 0; i < selectedFiles.length; i++) {
                    const imageData = await new Promise(resolve => {
                        const reader = new FileReader();
                        reader.onload = e => resolve(e.target.result);
                        reader.readAsDataURL(selectedFiles[i]);
                    });
                    const img = new Image();
                    await new Promise(resolve => { img.onload = resolve; img.src = imageData; });
                    const ratio = img.width / img.height;
                    let scaledW = pageW, scaledH = pageW / ratio;
                    if (scaledH > pageH) { scaledH = pageH; scaledW = pageH * ratio; }
                    if (i > 0) pdf.addPage();
                    pdf.addImage(img, 'JPEG', (pageW - scaledW) / 2, (pageH - scaledH) / 2, scaledW, scaledH);
                }
                pdf.save('converted-images.pdf');
                setButtonLoading(convertBtn, false, 'Convert to PDF');
                showNotification('PDF generated!');
                selectedFiles = []; updateUI();
            });
        }
        
        async function initPdfTextExtractor() {
            const fileDropArea = document.getElementById('fileDropArea');
            const fileInput = document.getElementById('fileInput');
            const extractBtn = document.getElementById('extractBtn');
            const resultContainer = document.getElementById('resultContainer');
            const extractedTextEl = document.getElementById('extractedText');
            const copyBtn = document.getElementById('copyBtn');
            let pdfFile = null;
            handleFileDrop(fileDropArea, fileInput, file => {
                if (file.type !== 'application/pdf') { showNotification('Please select a PDF file.', false); return; }
                pdfFile = file;
                extractBtn.disabled = false;
                fileDropArea.querySelector('p').textContent = file.name;
            });
            extractBtn.addEventListener('click', async () => {
                if (!pdfFile) return;
                setButtonLoading(extractBtn, true, 'Extract Text');
                const reader = new FileReader();
                reader.readAsArrayBuffer(pdfFile);
                reader.onload = async (e) => {
                    try {
                        const pdf = await pdfjsLib.getDocument(e.target.result).promise;
                        let fullText = '';
                        for (let i = 1; i <= pdf.numPages; i++) {
                            const page = await pdf.getPage(i);
                            const textContent = await page.getTextContent();
                            fullText += textContent.items.map(item => item.str).join(' ') + '\n\n';
                        }
                        extractedTextEl.value = fullText.trim();
                        resultContainer.style.display = 'block';
                        showNotification('Text extracted!');
                    } catch (error) {
                        showNotification('Could not read the PDF.', false);
                    } finally {
                        setButtonLoading(extractBtn, false, 'Extract Text');
                    }
                };
            });
            copyBtn.addEventListener('click', () => { if(extractedTextEl.value) copyToClipboard(extractedTextEl.value, 'Extracted text copied!'); });
        }
        
        function initQrGenerator() {
            const generateBtn = document.getElementById('generateBtn');
            const qrText = document.getElementById('qrText');
            const resultContainer = document.getElementById('resultContainer');
            const qrcodeContainer = document.getElementById('qrcode');
            generateBtn.addEventListener('click', () => {
                const text = qrText.value.trim();
                if (!text) { showNotification('Please enter text or a URL.', false); return; }
                qrcodeContainer.innerHTML = '';
                new QRCode(qrcodeContainer, { text: text, width: 200, height: 200, colorDark: "#0F0F1B", colorLight: "#ffffff", correctLevel: QRCode.CorrectLevel.H });
                resultContainer.style.display = 'flex';
                document.getElementById('downloadLink').onclick = e => { e.target.closest('a').href = qrcodeContainer.querySelector('img').src; };
            });
        }
        
        function initPasswordGenerator() {
            const outputEl = document.getElementById('passwordOutput');
            const lengthEl = document.getElementById('passwordLength');
            const lengthValueEl = document.getElementById('passwordLengthValue');
            const uppercaseEl = document.getElementById('includeUppercase');
            const lowercaseEl = document.getElementById('includeLowercase');
            const numbersEl = document.getElementById('includeNumbers');
            const symbolsEl = document.getElementById('includeSymbols');
            const generateBtn = document.getElementById('generatePasswordBtn');
            const copyBtn = document.getElementById('copyPasswordBtn');
            const charSets = { uppercase: 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', lowercase: 'abcdefghijklmnopqrstuvwxyz', numbers: '0123456789', symbols: '!@#$%^&*()_+~`|}{[]:;?><,./-=' };
            lengthEl.addEventListener('input', e => lengthValueEl.textContent = e.target.value);
            copyBtn.addEventListener('click', () => { if (outputEl.value) copyToClipboard(outputEl.value, 'Password copied!'); });
            generateBtn.addEventListener('click', () => {
                const length = +lengthEl.value;
                let charPool = (uppercaseEl.checked ? charSets.uppercase : '') + (lowercaseEl.checked ? charSets.lowercase : '') + (numbersEl.checked ? charSets.numbers : '') + (symbolsEl.checked ? charSets.symbols : '');
                if (charPool === '') { showNotification('Please select at least one character type.', false); return; }
                let password = '';
                for (let i = 0; i < length; i++) password += charPool.charAt(Math.floor(Math.random() * charPool.length));
                outputEl.value = password;
                showNotification('New password generated!');
            });
        }
        
        function initAgeCalculator() {
            const birthDateEl = document.getElementById('birthDate');
            document.getElementById('calculateAgeBtn').addEventListener('click', () => {
                const birthDate = new Date(birthDateEl.value);
                if (!birthDateEl.value || birthDate > new Date()) { showNotification('Please select a valid date of birth.', false); return; }
                const now = new Date();
                let years = now.getFullYear() - birthDate.getFullYear();
                let months = now.getMonth() - birthDate.getMonth();
                let days = now.getDate() - birthDate.getDate();
                if (days < 0) { months--; days += new Date(now.getFullYear(), now.getMonth(), 0).getDate(); }
                if (months < 0) { years--; months += 12; }
                document.getElementById('ageResult').innerHTML = `<strong>${years}</strong> years, <strong>${months}</strong> months, and <strong>${days}</strong> days`;
                const diffTime = Math.abs(now - birthDate);
                const totalDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));
                document.getElementById('ageUnitsResult').innerHTML = `<div class="result-item" style="background:rgba(0,0,0,0.2);padding:1rem;border-radius:8px;"><span>Total Months</span><strong>${(years * 12 + months).toLocaleString()}</strong></div><div class="result-item" style="background:rgba(0,0,0,0.2);padding:1rem;border-radius:8px;"><span>Total Weeks</span><strong>${Math.floor(totalDays / 7).toLocaleString()}</strong></div><div class="result-item" style="background:rgba(0,0,0,0.2);padding:1rem;border-radius:8px;"><span>Total Days</span><strong>${totalDays.toLocaleString()}</strong></div><div class="result-item" style="background:rgba(0,0,0,0.2);padding:1rem;border-radius:8px;"><span>Total Hours</span><strong>${Math.floor(diffTime / (1000*60*60)).toLocaleString()}</strong></div>`;
                document.getElementById('ageResultContainer').style.display = 'block';
            });
        }
        
        function initEmiCalculator() {
            document.getElementById('calculateEmiBtn').addEventListener('click', () => {
                const p = parseFloat(document.getElementById('loanAmount').value);
                const annualRate = parseFloat(document.getElementById('interestRate').value);
                const tenureYears = parseFloat(document.getElementById('loanTenure').value);
                if (isNaN(p) || isNaN(annualRate) || isNaN(tenureYears) || p <= 0 || annualRate <= 0 || tenureYears <= 0) { showNotification('Please enter valid, positive numbers.', false); return; }
                const r = (annualRate / 12) / 100, n = tenureYears * 12;
                const emi = (p * r * Math.pow(1 + r, n)) / (Math.pow(1 + r, n) - 1);
                const totalPayment = emi * n;
                const formatCurrency = (num) => num.toLocaleString('en-US', { style: 'currency', currency: 'USD' });
                document.getElementById('monthlyEmiResult').textContent = formatCurrency(emi);
                document.getElementById('totalInterestResult').textContent = formatCurrency(totalPayment - p);
                document.getElementById('totalPaymentResult').textContent = formatCurrency(totalPayment);
                document.getElementById('emiResultContainer').style.display = 'block';
            });
        }
        
        function initWordCounter() {
            document.getElementById('textInput').addEventListener('input', e => {
                const text = e.target.value;
                const words = text.trim().match(/\s+/g)?.length + 1 || (text.trim() ? 1 : 0);
                document.getElementById('wordCount').textContent = text.trim() ? words : 0;
                document.getElementById('charCount').textContent = text.length;
                document.getElementById('sentenceCount').textContent = text.match(/[^.!?]+[.!?]+/g)?.length || 0;
                document.getElementById('paragraphCount').textContent = text.split(/\n+/).filter(p => p.trim() !== '').length;
                document.getElementById('readingTime').textContent = `${Math.ceil((text.trim() ? words : 0) / 225)} min`;
            });
        }
        
        function initColorPicker() {
            const picker = document.getElementById('colorPickerInput');
            const preview = document.getElementById('colorPreview');
            const hexVal = document.getElementById('hexValue');
            const rgbVal = document.getElementById('rgbValue');
            const hslVal = document.getElementById('hslValue');
            const hexToRgb = h => `rgb(${parseInt(h.slice(1,3),16)}, ${parseInt(h.slice(3,5),16)}, ${parseInt(h.slice(5,7),16)})`;
            const hexToHsl = hex => {
                let r = parseInt(hex.slice(1,3),16)/255, g = parseInt(hex.slice(3,5),16)/255, b = parseInt(hex.slice(5,7),16)/255;
                let max = Math.max(r,g,b), min = Math.min(r,g,b), h, s, l = (max+min)/2;
                if(max==min) h=s=0; else { let d=max-min; s=l>0.5?d/(2-max-min):d/(max+min); switch(max){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break;} h/=6; }
                return `hsl(${Math.round(h*360)}, ${Math.round(s*100)}%, ${Math.round(l*100)}%)`;
            };
            const updateColors = c => { preview.style.backgroundColor = c; hexVal.value = c.toUpperCase(); rgbVal.value = hexToRgb(c); hslVal.value = hexToHsl(c); };
            picker.addEventListener('input', e => updateColors(e.target.value));
            document.querySelectorAll('.copy-btn[data-copy]').forEach(btn => btn.addEventListener('click', e => copyToClipboard(document.getElementById(e.currentTarget.dataset.copy).value)));
            updateColors(picker.value);
        }

        function initBase64Converter() {
            const textInput = document.getElementById('base64TextInput');
            const base64Output = document.getElementById('base64Output');
            document.getElementById('encodeBtn').addEventListener('click', () => { try { base64Output.value = btoa(unescape(encodeURIComponent(textInput.value))); } catch (e) { showNotification('Could not encode.', false); }});
            document.getElementById('decodeBtn').addEventListener('click', () => { try { textInput.value = decodeURIComponent(escape(atob(base64Output.value))); } catch (e) { showNotification('Invalid Base64.', false); }});
        }
        
        function initBmiCalculator() {
            const metricBtn = document.getElementById('metricBtn');
            const imperialBtn = document.getElementById('imperialBtn');
            const metricInputs = document.getElementById('metricInputs');
            const imperialInputs = document.getElementById('imperialInputs');
            metricBtn.addEventListener('click', () => { metricBtn.classList.add('active'); imperialBtn.classList.remove('active'); metricInputs.style.display='block'; imperialInputs.style.display='none'; });
            imperialBtn.addEventListener('click', () => { imperialBtn.classList.add('active'); metricBtn.classList.remove('active'); imperialInputs.style.display='block'; metricInputs.style.display='none'; });
            document.getElementById('calculateBmiBtn').addEventListener('click', () => {
                let weight, height;
                if (metricBtn.classList.contains('active')) { weight = parseFloat(document.getElementById('metricWeight').value); height = parseFloat(document.getElementById('metricHeight').value)/100; }
                else { const lbs=parseFloat(document.getElementById('imperialWeight').value), ft=parseFloat(document.getElementById('imperialHeightFt').value), inch=parseFloat(document.getElementById('imperialHeightIn').value); weight=lbs*0.453592; height=((ft*12)+inch)*0.0254; }
                if(isNaN(weight)||isNaN(height)||weight<=0||height<=0){ showNotification('Enter valid weight/height.',false); return; }
                const bmi = weight / (height * height);
                let category, color, gaugePercent;
                if (bmi < 18.5) { category = 'Underweight'; color = '#3B82F6'; gaugePercent = (bmi/18.5)*25; } 
                else if (bmi < 25) { category = 'Normal'; color = '#22C55E'; gaugePercent = 25 + ((bmi-18.5)/6.5)*25; }
                else if (bmi < 30) { category = 'Overweight'; color = '#FACC15'; gaugePercent = 50 + ((bmi-25)/5)*25; }
                else { category = 'Obesity'; color = '#EF4444'; gaugePercent = 75 + Math.min(25, ((bmi-30)/10)*25); }
                document.getElementById('bmiValue').textContent = bmi.toFixed(1);
                document.getElementById('bmiCategory').textContent = category;
                const gauge = document.getElementById('bmiResultGaugeIndicator');
                gauge.style.width = `${gaugePercent}%`; gauge.style.backgroundColor = color;
                document.getElementById('bmiResultContainer').style.display = 'block';
            });
        }
        
        function initTimerStopwatch() {
            let timer, stopwatch, timerSeconds = 300, isTimerRunning = false, stopwatchStartTime, stopwatchElapsedTime = 0, isStopwatchRunning = false;
            const timerDisplay = document.getElementById('timerDisplay'), startTimerBtn = document.getElementById('startTimerBtn');
            const updateTimer = () => { if(timerSeconds === 0) { clearInterval(timer); isTimerRunning=false; startTimerBtn.textContent='Start'; showNotification('Timer finished!'); } else { timerSeconds--; timerDisplay.textContent = `${String(Math.floor(timerSeconds/60)).padStart(2,'0')}:${String(timerSeconds%60).padStart(2,'0')}`; }};
            startTimerBtn.addEventListener('click', () => { if(isTimerRunning){ clearInterval(timer); startTimerBtn.textContent='Resume'; } else { if(timerSeconds<=0) timerSeconds = (parseInt(document.getElementById('timerMinutes').value)||5)*60; timer=setInterval(updateTimer,1000); activeToolIntervals.push(timer); startTimerBtn.textContent='Pause'; } isTimerRunning=!isTimerRunning; });
            document.getElementById('resetTimerBtn').addEventListener('click', () => { clearInterval(timer); isTimerRunning=false; startTimerBtn.textContent='Start'; timerSeconds=(parseInt(document.getElementById('timerMinutes').value)||5)*60; timerDisplay.textContent=`${String(Math.floor(timerSeconds/60)).padStart(2,'0')}:00`; });
            const stopwatchDisplay = document.getElementById('stopwatchDisplay'), startStopwatchBtn = document.getElementById('startStopwatchBtn');
            const updateStopwatch = () => { const elapsed = stopwatchElapsedTime + (Date.now()-stopwatchStartTime); stopwatchDisplay.textContent = `${String(Math.floor(elapsed/60000)).padStart(2,'0')}:${String(Math.floor((elapsed%60000)/1000)).padStart(2,'0')}.${String(Math.floor((elapsed%1000)/10)).padStart(2,'0')}`; };
            startStopwatchBtn.addEventListener('click', () => { if(isStopwatchRunning){ clearInterval(stopwatch); stopwatchElapsedTime+=Date.now()-stopwatchStartTime; startStopwatchBtn.textContent='Resume'; } else { stopwatchStartTime = Date.now(); stopwatch=setInterval(updateStopwatch,10); activeToolIntervals.push(stopwatch); startStopwatchBtn.textContent='Pause'; } isStopwatchRunning=!isStopwatchRunning; });
            document.getElementById('resetStopwatchBtn').addEventListener('click', () => { clearInterval(stopwatch); isStopwatchRunning=false; startStopwatchBtn.textContent='Start'; stopwatchElapsedTime=0; stopwatchDisplay.textContent='00:00.00'; });
        }
        
        function initJsonFormatter() {
            const formatBtn = document.getElementById('formatBtn'), copyBtn = document.getElementById('copyBtn'), jsonInput = document.getElementById('jsonInput'), jsonOutput = document.getElementById('jsonOutput'), resultTitle = document.getElementById('jsonResultTitle');
            formatBtn.addEventListener('click', () => { try { jsonOutput.textContent = JSON.stringify(JSON.parse(jsonInput.value), null, 2); resultTitle.innerHTML=`<i class="fas fa-check-circle" style="color:#22C55E"></i>Valid JSON`; copyBtn.style.display='block'; } catch(e) { jsonOutput.textContent=e.message; resultTitle.innerHTML=`<i class="fas fa-times-circle" style="color:#EF4444"></i>Invalid JSON`; copyBtn.style.display='none'; }});
            copyBtn.addEventListener('click', () => copyToClipboard(jsonOutput.textContent, 'Formatted JSON copied!'));
        }
        
        function initTextToSpeech() {
            const speakBtn = document.getElementById('speakBtn'), ttsText = document.getElementById('ttsText'), voiceSelect = document.getElementById('voiceSelect');
            let voices = [];
            function populateVoiceList() { voices=speechSynthesis.getVoices(); voiceSelect.innerHTML = voices.filter(v => v.lang.includes('en')).map(v => `<option value="${v.name}">${v.name} (${v.lang})</option>`).join(''); }
            populateVoiceList();
            if (speechSynthesis.onvoiceschanged !== undefined) speechSynthesis.onvoiceschanged = populateVoiceList;
            speakBtn.addEventListener('click', () => {
                if(speechSynthesis.speaking) speechSynthesis.cancel();
                if(ttsText.value !== '') {
                    const utterance = new SpeechSynthesisUtterance(ttsText.value);
                    utterance.voice = voices.find(v => v.name === voiceSelect.value);
                    utterance.onend = () => setButtonLoading(speakBtn, false, 'Speak');
                    setButtonLoading(speakBtn, true, 'Speak');
                    speechSynthesis.speak(utterance);
                }
            });
        }

        init();
    });
    </script>
</body>
</html>